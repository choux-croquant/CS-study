## [1 운영체제 개요](https://core.ewha.ac.kr/publicview/C0101020140307151724641842?vmode=f)

### 운영 체제란?

- 컴퓨터 하드웨어의 **바로 위**에 설치되는 소프트웨어 계층, 모든 컴퓨터 시스템의 필수적인 부분. 실제 하드웨어가 아닌 가상머신 위에서 실행되기도 한다.

- 좁은 의미의 운영체제 : 운영체제의 핵심적인 부분, 하드웨어 부팅 시 메모리에 상주. **커널**만을 의미

- 광의의 운영체제 : 커널 + 시스템 유틸리티, 메모리에 상주하지 않는 독립적인 프로그램을 의미

  

### 운영 체체의 목적

- 컴퓨터 시스템을 편리하게 사용할 수 있도록 하는 환경을 제공

  - 상위 계층의 응용 프로그램들이 메모리, CPU. I/O장치 등의 자원을 사용할 수 있도록 만들어 준다.

  - **자원을 효율적으로 관리**하는 기능(프로세스 스케줄링 ...)

  - 파일 시스템 등 자원의 추상화를 통한 접근성 향상

    

### 운영 체제의 분류

- **동시 작업 여부에 따른 구분**

  - Single Tasking 
    - 한 번에 하나의 프로그램만을 실행, MS-DOS ...
  - Multi Tasking
    - 동시에 두 개 이상의 프로그램을 실행할 수 있다. 현재 사용되는 대부분의 OS는 멀티태스킹 방식
    - 선점형과 협동형으로 구분된다.

- **사용자 수에 따른 구분**

  - Single User
    - 장치의 사용자 구별이 없는 형태의 OS, 프로세스의 병렬적인 실행은 허용한다.
  - Multi User
    - 디스크 공간 등 리소스와 프로세스를 식별하는 기능이 탑재되어 사용자를 구별할 수 있는 OS,  여러 사용자가 동시에 시스템과 상호 작용할 수 있다.

- **처리 방식에 따른 구분**

  - Batch Processing 

    - 작업 요청을 일정량 모아서 한 번에 처리하는 방식, 작업이 종료될 때까지 기다려야 한다.
    - Punch Card 처리 등 컴퓨터의 초기에 사용되었던 방식

  - Time Sharing

    - 프로세스 수행 시 컴퓨팅 능력을 일정한 시간 단위로 분할하여 사용하는 방식(시분할 방식)
    - 일괄 처리 방식에 비해 짧은 응답시간
    - Interactive한 방식

  - Realtime OS

    - 정해진 짧은 시간 안에 작업이 반드시 종료됨이 보장되어야 하는 실시간 시스템을 위한 방식

    - 싱글태스킹/멀티태스킹 방식 모두 존재한다.

    - 공장제어, 미사일 제어, 반도체 장비 등에 사용되는 OS

    - Hard realtime system / Soft realtime system - 시간 제약안에 응답하지 못한 경우 치명적인 영향을 주는지 여부에 따라 세부적으로 구분된 케이스.

      

### 운영 체제의 구조

- 개략적인 구조

  ![img](https://blog.kakaocdn.net/dn/S3U2H/btqHxbOhB2V/WeQANBQKfm6F58xkWsJZy0/img.png)

  + 크게 커널과 인터페이스로 나뉜다. 인터페이스는 커널과 사용자 사이를 이어주는 GUI로 커널에 대해 독립적이다. 즉 같은 커널이라도 다른 인터페이스를 장착할 수 있다.

  + 시스템 호출 : 응용 프로그램이나 사용자가 자원에 직접 접근하는 것을 방지하기 위해 만들어진 인터페이스, 즉 응용 프로그램이 OS에서 제공하는 기능이나 자원을 사용하려면 일반적으로 함수로 표현되는 시스템호출을 통해 사용해야 한다.

  + 드라이버 : 커널과 하드웨어 간의 인터페이스, 하드웨어의 종류가 다양하기 때문에 각 하드웨어에 맞는 인터페이스가 필요하므로 보통 하드웨어 제작자에게 (디바이스)드라이버를 받아 커널이 실행될 때 함께 실행되도록 한다.

    

## [2 시스템 구조 및 프로그램의 실행 Part-1](https://core.ewha.ac.kr/publicview/C0101020140311132925816476?vmode=f)

### 컴퓨터 시스템 구조

![img](https://i.imgur.com/8JAIHTg.png)

- Computer(CPU + Memory) + I/O Device
  - 메모리 : CPU의 작업공간, CPU가 메모리에서 instruction을 가져와 실행 CPU는 데이터 처리의 속도가 높지만 이로 인해 용량이 적기 때문에 주기억장치인 메모리에 실행할 명령들을 저장하고 그때그때 가져와 실행한다.

### Mode bit

- CPU에서 실행되는 것이 운영체제인지, 사용자 프로그램인지 구분하는 비트, **1이면 사용자 프로그램을 실행**하는 사용자 모드, **0이면 OS코드를 수행**하는 모니터 모드(커널 모드)이다. 보안을 위한 하드웨어적 장치.

### Timer

- 프로그램이 **무한루프에 빠져 CPU를 독점**하는 것을 막기 위한 장치, 할당된 시간이 지나면 프로그 CPU의 통제 권한이 프로그램에서 운영체제로 넘어간다. 클럭마다 1씩 타이머가 감소하여 0이 되면 타이머 인터럽트가 발생한다. 현재 시간을 계산하는 것에도 사용.

### Device Controller

- 각 I/O장치의 내부를 통제하는 장치, 장치의 CPU와 같은 역할 프로그램에서 각 I/O디바이스에서 할 작업을 요청하는 경우 CPU가 처리하는 것이 아니라 디바이스 컨트롤러가 처리한다.(병렬 처리)

  - Local Buffer : 각 I/O장치의 작업공간, 명령어를 저장하는 메모리와 유사(data register)

  - *펌웨어 : I/O디바이스가 동작하도록 하기 위한 소프트웨어

    

### [입출력과 인터럽트 (Input-Output and Interrupt)](/컴퓨터-구조/5장-기본-컴퓨터의-구조와-설계-Part2/입출력과-인터럽트.md)

### 인터럽트

+ 중단을 의미, 인터럽트 당한 시점의 레지스터와 program counter를 저장한 후 CPU제어를 인터럽트 처리 루틴에 넘기는 행위

+ 넓은 의미의 인터럽트 
  + Interrupt - 하드웨어(가 발생시킨) 인터럽트
  + Trap - 소프트웨어 인터럽트 (Exception + System call)

### 시스템 콜 (System Call)

- OS의 커널이 제공하는 기능에 프로그램이 접근하기 위해 사용하는 인터페이스. 일반적으로 고수준 언어로 작성된 프로그램들은 직접 시스템 콜을 할 수 없고 API를 통해 시스템 콜에 접근한다.

- 일반 프로그램은 커널 기능에 대해 접근 권한이 제어되어 있기 때문에 파일 시스템 등을 사용해야 할 경우 시스템 콜을 사용한다.

- 시스템 콜의 기능

  - 사용자 모드의 프로그램이 커널의 기능을 사용할 수 있도록 함
  - 시스템 콜을 하면 커널 모드로 전환
  - 커널에서 시스템 콜을 처리하면 다시 사용자 모드로 돌아가 작업 진행

- 시스템 콜의 유형

  - 프로세스 제어

  - 파일 조작

  - 장치 관리

  - 정보 유지

  - 통신

    

## [2 시스템 구조 및 프로그램의 실행 Part-2](https://core.ewha.ac.kr/publicview/C0101020140314151238067290?vmode=f)

### 동기식 입출력과 비동기식 입출력

- 동기식 입출력
  - I/O요청 후 입출력 작업이 완료된 후에 제어가 사용자 프로그램에 넘어간다.
- 비동기식 입출력
  - I/O가 시작된 후 작업이 끝나기를 기다리지 않고 제어가 사용자 프로그램으로 즉시 넘어간다.
- 두 경우 모두 I/O작업의 완료는 인터럽트로 알려준다.

### DMA (Direct Memory Access)

- DMA(Direct Memory Access ) Controller : I/O장치와 주메모리 간 데이터를 직접 전송하는 방식(DMA)의 버스를 제어하는 장치. 많은 데이터를 I/O하는 장치를 위해 **CPU가 항상 개입하는 것의 비효율성**(오버헤드 등)으로 인해 사용. CPU는 상태 정보 및 제어 정보만 전송한다. DMA를 통해 **인터럽트의 발생 횟수를 줄여** 효율을 높일 수 있다.
- DMA에 대한 추가 내용 : https://ko.wikipedia.org/wiki/%EC%A7%81%EC%A0%91_%EB%A9%94%EB%AA%A8%EB%A6%AC_%EC%A0%91%EA%B7%BC

### 서로 다른 입출력 명령어

- Memory-mapped I/O 
  - CPU가 입출력 장치에 액세스 할 때 입출력 장치와 메모리의 주소 공간을 분리하지 않고 하나의 메모리 공간에 취급하여 배치하는 방식. 따라서 입출력 장치의 메모리 주소가 따로 나뉘어 있지 않으므로 주메모리와 **같은 기계어 코드**를 통해 I/O를 수행한다.
  - Port-mapped I/O에 비해 CPU내부 로직이 덜 필요하기 때문에 보다 저렴하고 빠르고 쉽게 CPU를 구현할 수 있다.

### 저장장치 계층 구조

- [12장 메모리 구조](/컴퓨터-구조/12장-메모리-구조.md) 

### 프로그램의 실행 (메모리 load)

- 파일 시스템 내의 프로그램 실행파일 실행
- **가상 메모리**에 프로그램에 대한 메모리 주소 공간(Address space) 형성 (code + data + stack)
- 현재 실행 중인 프로세스의 필요한 **코드 일부만** 물리적 메모리에 Address translation
- 필요하지 않은 부분은 Swap area(physical memory의 메모리 연장 공간)로 이동

### 커널 주소 공간의 내용

+ 커널코드 + Data + Stack

- 커널 코드
  - 시스템콜, 인터럽트 처리 코드
  - 자원 관리를 위한 코드
  - 편리한 서비스 제공을 위한 코드
- Data
  - 하드웨어 종류에 따른 자료구조 구현체 (CPU + Memory + Disk ...)
  - 각 프로세스마다 운영체제가 관리하는 자료구조 구현체 - PCB
- Stack
  - 프로그램 마다 존재하는 커널 스택

### 사용자 프로그램이 사용하는 함수

+ 사용자 정의 함수 - 자신의 프로그램에서 정의한 함수
+ 라이브러리 함수
  + 자신의 프로그램에서 정의하지 않고 가져다 쓴 함수
  + 프로그램의 실행 파일에 포함
+ 커널 함수
  + 운영 체제 프로그램의 함수
  + 커넣 함수의 호출 = 시스템 콜